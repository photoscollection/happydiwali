<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Diwali Greetings â€” Personalized ðŸŽ†</title>
  <style>
    :root{--bg:#0b0312;--card:#0f0b16;--accent:#ffb86b}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial}
    body{background:radial-gradient(circle at 10% 10%, #1b0026 0%, var(--bg) 40%);color:#fff;display:flex;align-items:center;justify-content:center}
    .wrap{width:100%;max-width:1100px;margin:32px;padding:20px;border-radius:16px;backdrop-filter: blur(6px);}
    .ui{display:flex;gap:18px;align-items:center}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:18px;box-shadow:0 8px 30px rgba(2,2,2,0.6)}
    .left{flex:1;min-height:420px;position:relative;overflow:hidden;border-radius:12px}
    #three-canvas{width:100%;height:100%;display:block}
    .controls{width:380px}
    label{display:block;font-size:13px;margin-bottom:6px;color:#d9cfcf}
    input[type=text]{width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#fff;font-size:16px}
    button{margin-top:10px;padding:10px 14px;border-radius:10px;border:none;background:linear-gradient(90deg,#ffb86b,#ff6b6b);cursor:pointer;font-weight:600}
    .greeting{margin-top:18px;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));min-height:120px;display:flex;align-items:center;justify-content:center;text-align:center}
    .greeting h2{margin:0;font-size:20px}
    .small{font-size:13px;color:#cfc1c1;margin-top:8px}
    .credits{font-size:12px;color:#b9aeb1;margin-top:12px}
    .cta-row{display:flex;gap:10px}
    @media (max-width:880px){.ui{flex-direction:column}.controls{width:100%}}
  </style>
</head>
<body>
  <div class="wrap card">
    <div style="display:flex;align-items:flex-start;gap:18px;flex-wrap:wrap">
      <div class="left card" style="flex:1">
        <canvas id="three-canvas"></canvas>
      </div>
      <div class="controls">
        <label for="name">Enter your friend's name</label>
        <input id="name" type="text" placeholder="e.g. Ananya" autocomplete="off" />
        <div class="cta-row">
          <button id="make">Make Greeting</button>
          <button id="random">Surprise Me</button>
        </div><div class="greeting card" id="gcard">
      <div>
        <h2 id="greetingText">Type a name and press "Make Greeting" âœ¨</h2>
        <div class="small">This greeting is unique for the name â€” and will vary every visit to stay fresh.</div>
        <div class="credits">Share the page link or screenshot to send the greeting.</div>
      </div>
    </div>

    <div style="margin-top:10px;color:#cfc1c1;font-size:13px">
      Want a new animation or color theme? I can customize it for your repo.
    </div>
  </div>
</div>

  </div>  <!-- Three.js from CDN -->  <script src="https://unpkg.com/three@0.158.0/build/three.min.js"></script>  <script>
    // ---------- Greeting logic ----------
    const greetings = [
      "Happy Diwali, {{name}}! May your life glow with joy and success.",
      "Wishing you a sparkling Diwali, {{name}} â€” lights, laughter, and love.",
      "Diwali wishes to you, {{name}}: prosperity, peace, and endless sweets!",
      "May diyas light your way, {{name}}. Happy Diwali!",
      "Sparkles, sweets, and special moments â€” Happy Diwali, {{name}}!",
      "To {{name}} â€” may this Diwali bring new beginnings and bright memories."
    ];

    // small adjectives/phrases to make every visit slightly different
    const variants = ["âœ¨","ðŸª”","ðŸŽ†","â€” with love","from your friend","ðŸ’«","may abundance follow you"]

    function hashString(s){
      // simple djb2
      let h = 5381; for(let i=0;i<s.length;i++) h = ((h<<5)+h) + s.charCodeAt(i);
      return Math.abs(h);
    }

    function makeGreeting(name){
      name = (name||'Friend').trim();
      const base = greetings[ hashString(name) % greetings.length ];
      // pick a variant that changes with time so it's "new" on every visit
      const tvar = variants[ Math.floor((Date.now()/1000) % variants.length) ];
      return base.replace('{{name}}', escapeHtml(capitalize(name))) + ' ' + tvar;
    }

    function capitalize(s){ return s.charAt(0).toUpperCase()+s.slice(1); }
    function escapeHtml(unsafe){ return unsafe.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    document.getElementById('make').addEventListener('click', ()=>{
      const n = document.getElementById('name').value || 'Friend';
      showGreeting(makeGreeting(n));
      popDiya();
    });
    document.getElementById('random').addEventListener('click', ()=>{
      const randomName = ['Srijan','Amit','Ananya','Riya','Rahul','Priya'][Math.floor(Math.random()*6)];
      document.getElementById('name').value = randomName;
      showGreeting(makeGreeting(randomName));
      burstFireworks();
    });

    function showGreeting(text){
      const el = document.getElementById('greetingText');
      el.innerText = text;
      el.style.opacity = 0; el.animate([{opacity:0, transform:'translateY(8px)'},{opacity:1, transform:'translateY(0)'}],{duration:420,easing:'cubic-bezier(.2,.9,.2,1)'});
    }

    // ---------- Three.js Diya scene (simple, runs in-browser) ----------
    const canvas = document.getElementById('three-canvas');
    const renderer = new THREE.WebGLRenderer({canvas, antialias:true, alpha:true});
    renderer.setPixelRatio(window.devicePixelRatio);
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(45,1,0.1,100);
    camera.position.set(0,1.6,4);

    // ambient glow
    scene.add(new THREE.AmbientLight(0x442233,0.6));

    // ground subtle
    const ground = new THREE.Mesh(new THREE.PlaneGeometry(40,40), new THREE.MeshStandardMaterial({color:0x070012, metalness:0, roughness:1}));
    ground.rotation.x = -Math.PI/2; ground.position.y = -0.9; scene.add(ground);

    // group of diyas
    const diyaGroup = new THREE.Group(); scene.add(diyaGroup);

    function makeDiya(){
      const g = new THREE.Group();
      const bowl = new THREE.Mesh(new THREE.TorusGeometry(0.35,0.12,12,32,Math.PI*2), new THREE.MeshStandardMaterial({color:0x6b2f1a, metalness:0.3, roughness:0.7}));
      bowl.rotation.x = Math.PI/2; bowl.scale.y = 0.6; bowl.position.y = 0.02; g.add(bowl);
      const wax = new THREE.Mesh(new THREE.CylinderGeometry(0.08,0.08,0.08,12), new THREE.MeshStandardMaterial({color:0xffe5b4, metalness:0, roughness:0.8}));
      wax.position.y = 0.09; g.add(wax);
      const flameGeo = new THREE.ConeGeometry(0.05,0.15,10);
      const flameMat = new THREE.MeshBasicMaterial({color:0xffd36e});
      const flame = new THREE.Mesh(flameGeo, flameMat);
      flame.position.y = 0.17; flame.rotation.x = Math.PI; g.add(flame);

      // small point light for glow
      const pl = new THREE.PointLight(0xffb86b, 1, 3);
      pl.position.set(0,0.25,0);
      g.add(pl);

      return g;
    }

    // populate diyas
    for(let i=0;i<9;i++){
      const d = makeDiya();
      const a = (i/9)*Math.PI*2;
      const r = 1.5 + Math.sin(i)*0.12;
      d.position.set(Math.cos(a)*r, 0, Math.sin(a)*r);
      d.rotation.y = -a;
      diyaGroup.add(d);
    }

    // subtle animation of diyas floating
    const clock = new THREE.Clock();

    // fireworks particle system (Points)
    const particles = new THREE.BufferGeometry();
    const maxP = 400;
    const pos = new Float32Array(maxP*3);
    for(let i=0;i<pos.length;i++) pos[i]=1000; // offscreen initially
    particles.setAttribute('position', new THREE.BufferAttribute(pos,3));
    const pMat = new THREE.PointsMaterial({size:0.05});
    const pPoints = new THREE.Points(particles, pMat); scene.add(pPoints);

    function burstFireworks(){
      // place particles around center
      const positions = particles.attributes.position.array;
      for(let i=0;i<maxP;i++){
        const phi = Math.random()*Math.PI*2; const cost = Math.random()*2-1; const u = Math.random();
        const r = 0.6 + Math.random()*1.6;
        const x = Math.cos(phi)*Math.sqrt(1-cost*cost)*r;
        const y = cost*r + 0.3 + Math.random()*0.6;
        const z = Math.sin(phi)*Math.sqrt(1-cost*cost)*r;
        positions[i*3] = x; positions[i*3+1] = y; positions[i*3+2] = z;
      }
      particles.attributes.position.needsUpdate = true;
      // fade after a bit: gently move them up and out in the animation loop
      // we'll leave their motion to the render loop
    }

    function popDiya(){
      // gently scale the center diya and add a flash
      const first = diyaGroup.children[0];
      if(!first) return;
      const t0 = performance.now();
      const dur = 450;
      const startScale = first.scale.clone();
      const target = startScale.clone().multiplyScalar(1.18);
      const tick = ()=>{
        const p = Math.min(1, (performance.now()-t0)/dur);
        first.scale.lerpVectors(startScale,target, 1 - Math.pow(1-p,3));
        if(p<1) requestAnimationFrame(tick);
      }
      tick();
    }

    // resize handling
    function onResize(){
      const w = canvas.clientWidth; const h = canvas.clientHeight;
      renderer.setSize(w,h,false);
      camera.aspect = Math.max(0.1,w/h); camera.updateProjectionMatrix();
    }
    window.addEventListener('resize', onResize);

    // initial size
    canvas.style.width = '100%'; canvas.style.height = '100%';
    onResize();

    // animation loop
    function animate(){
      requestAnimationFrame(animate);
      const t = clock.getElapsedTime();
      // float diyas
      diyaGroup.children.forEach((d,i)=>{
        d.position.y = 0.05 + Math.sin(t*1.2 + i)*0.02;
        d.rotation.y += 0.002 + (i%3)*0.0005;
      });
      // particle drift (simple upward drift + fade)
      const positions = particles.attributes.position.array;
      for(let i=0;i<maxP;i++){
        const idx = i*3+1;
        if(positions[idx] > 900) continue; // offscreen
        positions[idx] += 0.002 + Math.random()*0.02; // rise
        positions[i*3] += (Math.random()-0.5)*0.01;
        positions[i*3+2] += (Math.random()-0.5)*0.01;
        // if too high, send offscreen
        if(positions[idx] > 4.5) { positions[i*3]=positions[idx]=positions[i*3+2]=1000; }
      }
      particles.attributes.position.needsUpdate = true;

      renderer.render(scene,camera);
    }
    animate();

    // small responsive canvas sizing loop (keeps pixel ratio crisp)
    let resizeRAF = null;
    function checkSize(){
      const w = canvas.clientWidth; const h = canvas.clientHeight;
      if(canvas.width !== Math.floor(w * devicePixelRatio) || canvas.height !== Math.floor(h * devicePixelRatio)){
        renderer.setSize(w,h,false);
        camera.aspect = Math.max(0.1,w/h); camera.updateProjectionMatrix();
      }
      resizeRAF = requestAnimationFrame(checkSize);
    }
    checkSize();

    // make one initial greeting for whoever opens the page (optional)
    showGreeting(makeGreeting('Friend'));
  </script></body>
</html>
